<div class="container my-3">
  <div id="carouselExampleControls" class="carousel slide" data-bs-ride="carousel">
    <div class="carousel-inner" style="max-height: 600px">
      <% @camp.photos.each do |photo| %>
        <div class="carousel-item active">
          <%= cl_image_tag photo.key, class: 'w-100 d-block img-fluid', alt: 'Slide Image of the Camp' %>
        </div>
      <% end %>
    </div>
    <button class="carousel-control-prev" type="button" data-bs-target="#carouselExampleControls" data-bs-slide="prev">
      <span class="carousel-control-prev-icon" aria-hidden="true"></span>
      <span class="visually-hidden">Previous</span>
    </button>
    <button class="carousel-control-next" type="button" data-bs-target="#carouselExampleControls" data-bs-slide="next">
      <span class="carousel-control-next-icon" aria-hidden="true"></span>
      <span class="visually-hidden">Next</span>
    </button>
  </div>
</div>
<div class="container">
    <div class="row">
        <div class="col-md-8">
            <div class="card">
                <div class="card-body">
                    <h3 class="card-title"><%= @camp.name %></h3>
                    <h6 class="text-muted card-subtitle mb-2">Anfitrion: <%= @camp.user.full_name %> |
                    Avalaible from: <%= @camp.start_date.to_fs(:short) %> to: <%= @camp.end_date.to_fs(:long) %> </h6>
                    <p class="card-text"><%= @camp.description %></p>
                    <div class="col">
                        <div class="d-flex justify-content-around">
                            <div class="text-start px-2">
                                <h4>Precio</h4>
                                <p><%= @camp.price %>€</p>
                            </div>
                            <div class="text-start px-2">
                                <h4>Huespedes</h4>
                                <p><%= @camp.capacity %> places</p>
                            </div>
                            <div class="text-start px-2">
                                <h4>Reseñas</h4>
                                <% if @camp.reviews.count > 0 %>
                                  <p>❤ <%= @camp.reviews.average(:rating).round(2) %> · <%= @camp.reviews.count %></p>
                                <% else %>
                                  <p>❤ <%= @camp.reviews.average(:rating) %> · <%= @camp.reviews.count %></p>
                                <% end %>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <%= image_tag 'map.jpg', class: 'w-100', style: 'height: 400px' %>
        </div>
        <div class="col-md-4">
          <div class="card box">
            <div class="mx-3">
              <h4 class="text-center">Reserva ahora</h4>
              <%= simple_form_for [@camp, @booking] do |f| %>
                <%= f.input :start_date, label: false, html5: true, input_html: { min: @camp.start_date, max: @camp.end_date - 1.day } %>
                <%= f.input :end_date, label:false, html5: true, input_html: { min: @camp.start_date + 1.day, max: @camp.end_date } %>
                <%= f.button :submit, "Reservar", class: "btn btn-outline-dark w-100" %>
              <% end %>
                <!--<h4 class="text-center">Book Now</h4>
                <div class="input-group"><span class="input-group-text">From:</span><input class="form-control" type="Date" /><button class="btn btn-primary" type="button">Book</button></div>
                <div class="input-group"><span class="input-group-text">To:</span><input class="form-control" type="Date" /><button class="btn btn-primary" type="button">Book</button></div>
                -->
            </div>
            <div class="mx-3">
                <h4 class="text-center">Recomendaciones</h4>
                <ul class="list-group">
                    <li class="list-group-item list-group-item-info text-center">Adquiera el calzado adecuado.</li>
                    <li class="list-group-item list-group-item-info text-center">No cargue con exceso de equipación.</li>
                    <li class="list-group-item list-group-item-info text-center">Llegue de día a la zona de acampada.</li>
                </ul>
            </div>
            <div class="m-2">
                <h4 class="text-center my-2">Comparte</h4>
                <ul class="list-inline d-flex justify-content-center">
                  <li class="list-inline-item">
                    <li class="fa-brands fa-facebook-f"></li>
                  </li>
                  <li class="list-inline-item">
                    <li class="fa-brands fa-twitter"></li>
                  </li>
                  <li class="list-inline-item">
                    <li class="fa-brands fa-instagram"></li>
                  </li>
                </ul>
            </div>
            <div class="mx-3">
              <% if user_signed_in? && current_user.reviewed?(@camp) %>
                <h4 class="text-center">Deja tu reseña</h4>
                <div class="col py-2">
                  <%= simple_form_for [ @camp, @review ], wrapper: :input_group do |f| %>
                    <%= f.input :rating, label:false do %>
                      <%= f.input_field :rating, as: :select, collection: (1..5),
                      data: { controller: 'star-rating' } %>
                    <% end %>
                    <%= f.input :content, class:'form-control',
                    label:false, placeholder: 'Escribe tu reseña' %>
                    <%= f.button :submit, class: 'btn btn-outline-dark w-100', value: 'Comment' %>
                  <% end %>
                  </div>
                <% end %>
           <!-- <div class="input-group">
              <span class="input-group-text">❤❤❤❤❤</span>
              <input class="form-control" type="text" />
              <button class="btn btn-primary" type="button">Comment</button>
            </div> -->
            </div>
            </div>
        </div>
    </div>
</div>
<div class="container py-4 py-xl-5">
    <div class="row mb-5">
      <h2 class="text-center">Reseñas</h2>
      <hr>
    </div>
    <div class="row gy-4 row-cols-1 row-cols-sm-2 row-cols-lg-3">
      <% @camp.reviews.each do |review| %>
        <div class="col">
          <div>
            <div class="d-flex justify-content-between bg-light border rounded border-0 border-light p-4">
              <p class="flex-grow-1"><%= review.content %></p>
              <p class="text-end"><%= "❤#{review.rating}" %></p>
            </div>
            <div class="d-flex">
            <%= image_tag 'campingnb.ico', class: 'rounded-circle flex-shrink-0 me-3 fit-cover',
            style: 'height: 50px; width: 50px;' %>
              <div>
                  <p class="fw-bold text-primary mb-0"><%= review.user.full_name %></p>
                  <p class="text-muted mb-0"><%= review.created_at.to_fs(:long) %></p>
              </div>
            </div>
          </div>
        </div>
      <% end %>
    </div>
</div>
